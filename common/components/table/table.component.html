@if (config().filter) {
  <mat-form-field class="filter">
    <mat-label>{{ "FILTER" | translate }}</mat-label>
    <input
      matInput
      (keyup)="applyFilter($event)"
      [placeholder]="config().filter!.placeholder"
    />
  </mat-form-field>
}

<div class="table-margin mat-elevation-z8">
  <mat-table
    [class.disable-table]="shouldShowSpinner"
    [dataSource]="dataSource"
    matSort
  >
    @for (column of config().columns; track column.columnDef) {
      <ng-container
        [matColumnDef]="column.columnDef"
        [sticky]="column.sticky"
        [stickyEnd]="column.stickyEnd"
      >
        <mat-header-cell
          *matHeaderCellDef
          [style]="'min-width:' + column.minWidth"
          matSort
        >
          {{ column.header | textConfigTranslate }}
        </mat-header-cell>

        <mat-cell
          *matCellDef="let row"
          [style]="'min-width:' + column.minWidth"
        >
          <app-table-row [column]="column" [row]="row"></app-table-row>
        </mat-cell>
      </ng-container>
    }

    @for (column of config().columnsWithIcon; track column.columnName) {
      <ng-container [matColumnDef]="column.columnName">
        <mat-header-cell *matHeaderCellDef class="action-column-width" />
        <mat-cell *matCellDef="let row" class="action-column-width">
          <button
            mat-icon-button
            class="action-button"
            [disabled]="shouldShowSpinner"
            (click)="column.onClick(row.data)"
          >
            <mat-icon>{{ column.icon }}</mat-icon>
          </button>
        </mat-cell>
      </ng-container>
    }

    @if (config().actionsDefinition) {
      <app-table-actions-definition
        [actionsDefinition]="config().actionsDefinition!"
        [shouldShowSpinner]="shouldShowSpinner"
      ></app-table-actions-definition>
    }

    <ng-container matColumnDef="tableIsEmptyColumn">
      <mat-footer-cell *matFooterCellDef class="empty-table-cell">
        <span>{{ "EMPTY_TABLE" | translate }}</span>
      </mat-footer-cell>
    </ng-container>

    <mat-header-row
      *matHeaderRowDef="config().columnNames; sticky: config().headerSticky"
    />
    <mat-row
      *matRowDef="let row; columns: config().columnNames"
      [class.mark-row]="config().markRowCondition(row.data)"
      [class.hovered]="row.hovered"
      [class.highlighted]="selection.isSelected(row)"
      (click)="onRowClick(row)"
      (mouseover)="onMouseOver(row)"
      (mouseout)="onMouseOut(row)"
    />
    <mat-footer-row
      *matFooterRowDef="['tableIsEmptyColumn']"
      class="empty-table"
      [class.hide-element]="!isTableEmpty"
    />
  </mat-table>

  @if (config().paginator) {
    <mat-paginator
      [pageSizeOptions]="config().paginator!.getPageSizes()"
      [pageSize]="dataSource.pagination.pageSize"
      [pageIndex]="dataSource.pagination.pageNumber - 1"
      [showFirstLastButtons]="config().paginator!.showFirstLastButtons"
      [length]="dataSource.totalCount"
      (page)="onPageChange($event)"
    />
  }

  @if (shouldShowSpinner) {
    <div class="inner">
      <mat-spinner />
    </div>
  }
</div>
